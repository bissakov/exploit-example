from django.shortcuts import render, redirect
from register.forms import UserSignupForm
from django.http import HttpResponseRedirect, HttpResponse
import pickle
import base64
# Create your views here

def set_cookie(request):
    response = HttpResponse('Cookie Set')  
    username = None
    if request.user.is_authenticated:
        username = request.user.username
    val = base64.urlsafe_b64encode(pickle.dumps(username)).rstrip(b'=')
    response.set_cookie('unamepickled', val, max_age=300)
    return response
    # return redirect('/home')

def register(response):
    if response.method == 'POST':
        signup_form = UserSignupForm(response.POST)
        if signup_form.is_valid():
            signup_form.save()
            return redirect('/login')
    else:
        signup_form = UserSignupForm()
    return render(response, 'register/register.html', {'form': signup_form})

def login(response):
    return render(response, 'registration/login.html')#, {'form': login_form})

### redirect to setcookie

def home(response):
    # response = set_cookie(response)
    # response = exploit(response)
    return render(response, 'register/home.html')

def about(response):
    # response = set_cookie(response)
    return render(response, 'register/about.html')